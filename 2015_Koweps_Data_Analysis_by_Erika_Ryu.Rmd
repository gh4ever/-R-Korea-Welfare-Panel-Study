---
title: "2015_Koweps_Data_Analysis_by_Erika_Ryu"
author: "jhryu"
date: "2025-08-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(haven)
library(dplyr)
library(ggplot2)

# ğŸ“‚ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ë³€ìˆ˜ëª… ë³€ê²½
data <- read_sav("Koweps_hpc10_2015_beta10.sav")

data <- rename(data,
               sex = h10_g3,         # ì„±ë³„
               birth = h10_g4,       # ì¶œìƒë…„ë„
               marriage = h10_g10,   # ê²°í˜¼ì—¬ë¶€
               income = p1002_8aq1,  # ì›”ê¸‰
               code_job = h10_eco9,  # ì§ì¢…ì½”ë“œ
               code_region = h10_reg7) # ì§€ì—­ì½”ë“œ

summary(data)
str(data)

# ğŸ§¼ ì„±ë³„ ë³€ìˆ˜ ì „ì²˜ë¦¬
data$sex <- ifelse(data$sex == 9, NA, data$sex)
data$sex <- factor(data$sex, levels = c(1, 2), labels = c("male", "female"))
qplot(data$sex)

# ğŸ“ˆ ì„±ë³„ í‰ê·  ì›”ê¸‰

sex_income <- data %>%
  filter(!is.na(income)) %>%
  group_by(sex) %>%
  summarise(mean_income = mean(income))

ggplot(sex_income, aes(x = sex, y = mean_income, fill = sex)) +
  geom_col() +
  labs(title = "ì„±ë³„ í‰ê·  ì›”ê¸‰ ë¹„êµ", x = "ì„±ë³„", y = "í‰ê·  ì›”ê¸‰(ë§Œì›)") +
  theme_minimal()

# ğŸ§® ë‚˜ì´ ê³„ì‚° ë° ì‹œê°í™”
data$age <- 2015 - data$birth + 1
qplot(data$age)

# ğŸ“ˆ ë‚˜ì´ë³„ í‰ê·  ì›”ê¸‰
age_income <- data %>%
  filter(!is.na(income)) %>%
  group_by(age) %>%
  summarise(mean_income = mean(income))

ggplot(age_income, aes(x = age, y = mean_income)) +
  geom_line() +
  labs(title = "ë‚˜ì´ì— ë”°ë¥¸ í‰ê·  ì›”ê¸‰", x = "ë‚˜ì´", y = "í‰ê·  ì›”ê¸‰(ë§Œì›)")

# ğŸ§  ì—°ë ¹ëŒ€ ë³€ìˆ˜ ìƒì„±
data <- data %>%
  mutate(ageg = case_when(
    age < 30 ~ "young",
    age < 60 ~ "middle",
    TRUE ~ "old"
  ))

qplot(data$ageg)

# ğŸ“Š ì—°ë ¹ëŒ€ë³„ í‰ê·  ì›”ê¸‰
ageg_income <- data %>%
  filter(!is.na(income)) %>%
  group_by(ageg) %>%
  summarise(mean_income = mean(income))

ggplot(ageg_income, aes(x = factor(ageg, levels = c("young", "middle", "old")), y = mean_income)) +
  geom_col() +
  labs(title = "ì—°ë ¹ëŒ€ë³„ í‰ê·  ì›”ê¸‰", x = "ì—°ë ¹ëŒ€", y = "í‰ê·  ì›”ê¸‰(ë§Œì›)")

#ğŸ“Š ì„±ë³„Â·ì—°ë ¹ëŒ€ë³„ í‰ê·  ì›”ê¸‰
sex_ageg_income <- data %>%
  filter(!is.na(income)) %>%
  group_by(ageg, sex) %>%
  summarise(mean_income = mean(income))

ggplot(sex_ageg_income, aes(x = factor(ageg, levels = c("young", "middle", "old")), y = mean_income, fill = sex)) +
  geom_col(position = "dodge") +
  labs(title = "ì„±ë³„Â·ì—°ë ¹ëŒ€ë³„ í‰ê·  ì›”ê¸‰ ë¹„êµ", x = "ì—°ë ¹ëŒ€", y = "í‰ê·  ì›”ê¸‰(ë§Œì›)")

# ğŸ“ˆ ì„±ë³„Â·ë‚˜ì´ë³„ ì›”ê¸‰ ì¶”ì´
sex_age <- data %>%
  filter(!is.na(income)) %>%
  group_by(age, sex) %>%
  summarise(mean_income = mean(income))

ggplot(sex_age, aes(x = age, y = mean_income, color = sex)) +
  geom_line() +
  labs(title = "ì„±ë³„ì— ë”°ë¥¸ ë‚˜ì´ë³„ í‰ê·  ì›”ê¸‰", x = "ë‚˜ì´", y = "í‰ê·  ì›”ê¸‰(ë§Œì›)")

# ğŸ“Š ì„±ë³„ í‰ê·  ì›”ê¸‰ ì°¨ì´ì˜ í†µê³„ì  ìœ ì˜ì„± ê²€ì •
t.test(income ~ sex, data = data)

# ì´ê±° ì•ˆë˜ë©´,
data_ttest <- data %>% filter(!is.na(income), !is.na(sex))
t.test(income ~ sex, data = data_ttest)